jQuery.extend({createUploadIframe:function(e,t){var r="jUploadFrame"+e,a='<iframe id="'+r+'" target="_self" name="'+r+'" style="position:absolute; top:-9999px; left:-9999px"';return window.ActiveXObject&&("boolean"==typeof t?a+=' src="javascript:false"':"string"==typeof t&&(a+=' src="'+t+'"')),a+=" />",jQuery(a).appendTo(document.body),jQuery("#"+r).get(0)},createUploadForm:function(e,t,r){var a="jUploadForm"+e,o="jUploadFile"+e,n=jQuery('<form  action="" method="POST" name="'+a+'" id="'+a+'" enctype="multipart/form-data"></form>');if(r)for(var u in r)jQuery('<input type="hidden" name="'+u+'" value="'+r[u]+'" />').appendTo(n);for(var u in t){var c=jQuery("#"+t[u]),d=jQuery(c).clone();jQuery(c).attr("id",o),jQuery(c).before(d),jQuery(c).appendTo(n)}return jQuery(n).css("position","absolute"),jQuery(n).css("top","-1200px"),jQuery(n).css("left","-1200px"),jQuery(n).appendTo("body"),n},ajaxFileUpload:function(o){o=jQuery.extend({},jQuery.ajaxSettings,o);var e=(new Date).getTime(),n=jQuery.createUploadForm(e,o.fileElementId,void 0!==o.data&&o.data),u=(jQuery.createUploadIframe(e,o.secureuri),"jUploadFrame"+e),t="jUploadForm"+e;o.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var c=!1,d={};o.global&&jQuery.event.trigger("ajaxSend",[d,o]);var r=function(e){var t=document.getElementById(u);try{t.contentWindow?(d.responseText=t.contentWindow.document.body?t.contentWindow.document.body.innerHTML:null,d.responseXML=t.contentWindow.document.XMLDocument?t.contentWindow.document.XMLDocument:t.contentWindow.document):t.contentDocument&&(d.responseText=t.contentDocument.document.body?t.contentDocument.document.body.innerHTML:null,d.responseXML=t.contentDocument.document.XMLDocument?t.contentDocument.document.XMLDocument:t.contentDocument.document)}catch(e){jQuery.handleError(o,d,null,e)}if(d||"timeout"==e){var r;c=!0;try{if("error"!=(r="timeout"!=e?"success":"error")){var a=jQuery.uploadHttpData(d,o.dataType);o.success&&o.success(a,r),o.global&&jQuery.event.trigger("ajaxSuccess",[d,o])}else jQuery.handleError(o,d,r)}catch(e){r="error",jQuery.handleError(o,d,r,e)}o.global&&jQuery.event.trigger("ajaxComplete",[d,o]),o.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),o.complete&&o.complete(d,r),jQuery(t).unbind(),setTimeout(function(){try{jQuery(t).remove(),jQuery(n).remove()}catch(e){jQuery.handleError(o,d,null,e)}},100),d=null}};0<o.timeout&&setTimeout(function(){c||r("timeout")},o.timeout);try{n=jQuery("#"+t);jQuery(n).attr("action",o.url),jQuery(n).attr("method","POST"),jQuery(n).attr("target",u),n.encoding?jQuery(n).attr("encoding","multipart/form-data"):jQuery(n).attr("enctype","multipart/form-data"),jQuery(n).submit()}catch(e){jQuery.handleError(o,d,null,e)}return jQuery("#"+u).load(r),{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;return data="xml"==type||data?r.responseXML:r.responseText,"script"==type&&jQuery.globalEval(data),"json"==type&&-1!=data.search("{")&&(data=("Microsoft Internet Explorer"==navigator.appName||0<navigator.userAgent.indexOf("Trident")||(data=data.substring(data.search("{"),data.length-6)),eval("("+data+")"))),"html"==type&&-1!=data.search("{")&&(data=eval("("+data+")")),data},handleError:function(e,t,r,a){e.error&&e.error.call(e.context||e,t,r,a),e.global&&(e.context?jQuery(e.context):jQuery.event).trigger("ajaxError",[t,e,a])}});